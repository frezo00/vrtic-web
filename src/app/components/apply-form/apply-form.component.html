<div class="form__container" fxLayout="column">
  <app-subheader [title]="'Glazbeni Vrtić'" [subtitle]="'Upisi za 2018. / 2019. godinu'"></app-subheader>
  <div class="form__wrapper" fxFlexFill fxLayoutAlign="center strech">
    <div class="form__content" fxLayout="column" fxLayoutAlign="start strech" fxFlex="100%" fxFlex.gt-sm="80%" fxLayoutGap="16px">
      <div [ngStyle]="{'display': !success ? 'flex' : 'none'}" class="form__information-container" fxLayout="column">
        <h3 class="form__information-title">Upis novih članova počinje UPRAVO SADA!</h3>
        <p class="form__information-text">
          Došlo je vrijeme za još jedno druženje u našem Glazbenom vrtiću. Broj mjesta je ograničen, stoga požurite i osigurajte mjesto
          Vašem mališanu. Upisi će biti otvoreni <b>do početka rujna 2018. godine</b>.
        </p>
        <p class="form__information-text">
          Detaljnije informacije možete dobiti na brojeve telefona: <br>
          <a href="tel:+38763468055">063/468-055</a> i <a href="tel:+38763464617">063/464-617</a> <br> ili putem facebook
          i instagram stranice: <b>Glazbeni vrtić Posušje</b>.
        </p>
        <span class="form__information-announce">Radujemo se novim glazbenim avanturama!</span>
      </div>
      <form [ngStyle]="{'display': !success ? 'flex' : 'none'}" [formGroup]="applyForm" (ngSubmit)="onSubmit()" fxLayout="column"
        fxLayoutGap="12px">
        <div class="form__wrapper" fxLayout.lt-sm="column" fxLayoutGap="12px">
          <div class="form__field" fxLayout="column-reverse" fxFlex="100%" fxFlex.gt-xs="50%">
            <span [ngClass]="{'active': (firstName.touched && firstName.invalid)}" class="form__error-msg">
              {{firstName.hasError('required') ? 'Ovo polje je obavezno' : firstName.hasError('maxlength') ? 'Tekst je predug' :''}}
            </span>
            <input class="form__input" type="text" formControlName="firstName" required>
            <p class="form__label">Ime</p>
          </div>
          <div class="form__field" fxLayout="column-reverse" fxFlex="100%" fxFlex.gt-xs="50%">
            <span [ngClass]="{'active': (lastName.touched && lastName.invalid)}" class="form__error-msg">
              {{lastName.hasError('required') ? 'Ovo polje je obavezno' : lastName.hasError('maxlength') ? 'Tekst je predug' :''}}
            </span>
            <input class="form__input" type="text" formControlName="lastName" required>
            <p class="form__label">Prezime</p>
          </div>
        </div>
        <div class="form__wrapper" fxLayout.lt-sm="column" fxLayoutGap="12px">
          <div class="form__field" fxLayout="column-reverse" fxFlex="100%" fxFlex.gt-xs="50%">
            <span [ngClass]="{'active': (birthdate.touched && birthdate.invalid)}" class="form__error-msg">
              {{birthdate.hasError('required') ? 'Ovo polje je obavezno' : birthdate.hasError('maxlength') ? 'Neispravan format datuma'
              :''}}
            </span>
            <input *ngIf="!!mobileQuery.matches" class="form__input form__date-mobile" type="date" formControlName="birthdate" [min]="minDate|date:'yyyy-MM-dd'"
              [max]="maxDate|date:'yyyy-MM-dd'" required>
            <input [ngClass]="{'hide': !!mobileQuery.matches}" class="form__input form__date-input" ngx-mydatepicker formControlName="birthdate"
              [options]="myOptions" #dp="ngx-mydatepicker" required readonly [defaultMonth]="defaultMonth">
            <span *ngIf="!mobileQuery.matches" class="form__date-icon" (click)="dp.toggleCalendar()">
              <fa-icon [icon]="dateIcon"></fa-icon>
            </span>
            <p class="form__label">Datum rođenja</p>
          </div>
          <div class="form__field" fxLayout="column-reverse" fxFlex="100%" fxFlex.gt-xs="50%">
            <span [ngClass]="{'active': (parentsNames.touched && parentsNames.invalid)}" class="form__error-msg">
              {{parentsNames.hasError('required') ? 'Ovo polje je obavezno' : parentsNames.hasError('maxlength') ? 'Tekst je predug' :''}}
            </span>
            <input class="form__input" type="text" formControlName="parentsNames" required>
            <p class="form__label">Ime oba roditelja</p>
          </div>
        </div>
        <div class="form__wrapper" fxLayout.lt-sm="column" fxLayoutGap="12px">
          <div class="form__field" fxLayout="column-reverse" fxFlex="100%" fxFlex.gt-xs="50%">
            <span [ngClass]="{'active': (phoneNumber.touched && phoneNumber.invalid)}" class="form__error-msg">
              {{phoneNumber.hasError('required') ? 'Ovo polje je obavezno' : 'Neispravan format telefonskog broja'}}
            </span>
            <input class="form__input" type="tel" formControlName="phoneNumber" required>
            <p class="form__label">Telefon / Mobitel</p>
          </div>
          <div class="form__field" fxLayout="column-reverse" fxFlex="100%" fxFlex.gt-xs="50%">
            <span [ngClass]="{'active': (email.touched && email.invalid)}" class="form__error-msg">Neispravan email format</span>
            <input class="form__input" type="email" formControlName="email">
            <p class="form__label">Email
              <span>(nije obavezno)</span>
            </p>
          </div>
        </div>
        <div class="form__wrapper" fxLayout.lt-sm="column" fxLayoutGap="12px">
          <div class="form__field" fxLayout="column-reverse" fxFlex="100%">
            <span [ngClass]="{'active': (message.touched && message.invalid)}" class="form__error-msg">
              {{message.hasError('maxlength') ? 'Tekst je predug' : ''}}
            </span>
            <textarea class="form__input form__textarea" formControlName="message" rows="4"></textarea>
            <p class="form__label">Napomena
              <span>(nije obavezno)</span>
            </p>
          </div>
          <div style="display: none;" class="form__field">
            <re-captcha #captchaRef="reCaptcha" size="invisible" formControlName="recaptcha" siteKey="6LcjcmoUAAAAALOQ4hCEJiq9ElNiqU2xv1YMk0tf"
              (resolved)="$event && onSubmit()"></re-captcha>
          </div>
        </div>

        <div class="form__action" fxFlex="100%" fxLayoutAlign="center center">
          <button type="button" class="action-button" [disabled]="applyForm.invalid" (click)="captchaRef.execute()">Pošalji</button>
        </div>
      </form>
      <app-success-confirm *ngIf="!!success" (resetForm)="resetForm()"></app-success-confirm>
    </div>
  </div>
</div>

<app-loading *ngIf="!!loading" fxLayout="column" fxLayoutAlign="center center"></app-loading>
<app-modal *ngIf="!!openModal" (cancel)="openModal = false" (confirm)="route.navigateByUrl(targetUrl)"></app-modal>
